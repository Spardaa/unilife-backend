# 柔性显示改进总结

## 用户反馈

**问题**：原来的柔性显示只写"大概1小时"，看不到什么时候结束，不直观。

**原显示**：
```
10:00 开会（约1小时）
14:00 写代码（约1小时30分钟）
18:00 健身（约1小时，AI估计）
```

**用户需求**：希望也能看到大概的结束时间，方便安排后续事件。

---

## 改进方案

在柔性显示中添加**预计结束时间**：

```
10:00 开会（1小时，到11:00左右）
14:00 写代码（约1小时30分钟，到15:30左右）
18:00 健身（约1小时，AI估计，预计到19:00左右）
```

---

## 显示规则

### 用户明确指定时长
```
10:00 开会（1小时，到11:00左右）
14:00 团队周会（1小时30分钟，到15:30左右）
```
- 显示实际时长
- 使用"到"连接结束时间

### AI 高置信度估计（≥0.7）
```
10:00 写代码（约1小时，到11:00左右）
14:00 学习（约2小时，到16:00左右）
```
- 显示"约"表示估计
- 置信度高，不显示"AI估计"标注
- 使用"到"连接结束时间

### AI 低置信度估计（<0.7）
```
10:00 健身（约1小时，AI估计，预计到11:00左右）
14:00 购物（约1小时30分钟，AI估计，预计到15:30左右）
```
- 显示"AI估计"标注
- 使用"预计到"表示不确定性
- 结束时间后加"左右"

### 默认值
```
10:00 新事件（约1小时，到11:00左右）
```
- 显示"约"表示估计
- 使用"到"连接结束时间

---

## 优势对比

### 改进前
```
事件列表：
○ 10:00 开会（约1小时）
○ 14:00 写代码（约1小时30分钟）

问题：
✗ 看不到什么时候结束
✗ 不知道能否安排下一个事件
✗ 需要自己计算结束时间
```

### 改进后
```
事件列表：
○ 10:00 开会（约1小时，到11:00左右）
○ 14:00 写代码（约1小时30分钟，到15:30左右）

优势：
✓ 一目了然看到结束时间
✓ 方便安排后续事件
✓ 保留柔性，减少焦虑
✓ AI 信息来源清晰
```

---

## 技术实现

### 核心逻辑
```python
# 计算预计结束时间
estimated_end = start_time + timedelta(minutes=duration)

# 构建显示信息
info_parts = []

# 1. 添加时长信息
if show_ai_note:
    info_parts.append(f"约{duration_text}，AI估计")
elif duration_source == "ai_estimate":
    info_parts.append(f"约{duration_text}")
else:
    info_parts.append(duration_text)

# 2. 添加结束时间
if duration_source == "ai_estimate" and duration_confidence < 0.7:
    info_parts.append(f"预计到{end_str}左右")  # 低置信度用"预计到"
else:
    info_parts.append(f"到{end_str}左右")      # 其他情况用"到"

# 组合显示
result = f"{time_str} {title}（{info}）"
```

---

## 用户体验提升

### 1. 更直观
- 一眼看到开始和结束时间
- 无需手动计算

### 2. 更灵活
- 保留"左右"、"约"等柔性词汇
- 不会感觉死板

### 3. 更智能
- AI 信息来源清晰标注
- 根据置信度调整用词

### 4. 更实用
- 方便安排后续事件
- 减少认知负担

---

## 示例对比

### 场景1：日常工作安排

**改进前**：
```
9:00 开会（约1小时）
14:00 写代码（约2小时）
16:00 健身（约1小时，AI估计）

用户需要思考：
- 开会几点结束？10点？
- 写代码几点结束？16点？
- 能否安排健身？
```

**改进后**：
```
9:00 开会（约1小时，到10:00左右）
14:00 写代码（约2小时，到16:00左右）
16:00 健身（约1小时，AI估计，预计到17:00左右）

用户一目了然：
- 开会10点结束，刚好衔接
- 写代码16点结束，不冲突
- 可以安排健身
```

---

## 总结

这次改进在保留柔性时间优势的同时，**解决了可视性问题**：

1. ✅ **保留柔性**：使用"约"、"左右"等柔性词汇
2. ✅ **提高可视性**：显示预计结束时间
3. ✅ **信息完整**：时长 + 结束时间 + AI 标注
4. ✅ **智能标注**：根据置信度调整用词（"到" vs "预计到"）

用户既能感受到灵活性的舒适，又能清晰地看到时间安排！
